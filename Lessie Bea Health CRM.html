<html>
        <head><title>Downloaded HTML</title></head>
        <body>
            <pre style="white-space: pre-wrap; word-wrap: break-word;"><!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lessie Bea Health CRM üíú</title>
  <style>
    :root{
      --primary:#7B4AE2;
      --accent:#BFA7F2;
      --bg:#F6F2FF;
      --text:#2E1A47;
      --muted: rgba(46,26,71,0.75);
      --border: rgba(46,26,71,0.18);
      --shadow: 0 6px 18px rgba(123, 74, 226, 0.15);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 18px;
    }

    header{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      margin-bottom: 14px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    h1{
      margin:0;
      font-size: 26px;
      color: var(--primary);
    }

    .sub{
      margin:0;
      font-size: 13px;
      color: var(--muted);
    }

    .topActions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pill{
      background: rgba(191, 167, 242, 0.25);
      border: 1px solid rgba(123, 74, 226, 0.25);
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 13px;
      color: var(--text);
      white-space:nowrap;
    }

    .btn{
      background: var(--primary);
      color:#fff;
      border:none;
      border-radius: 12px;
      padding: 10px 14px;
      cursor:pointer;
      box-shadow: var(--shadow);
    }
    .btn.secondary{
      background: #2E1A47;
    }
    .btn.light{
      background: var(--accent);
      color: var(--text);
      box-shadow: none;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background:#fff;
      border-radius:16px;
      padding:16px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(123, 74, 226, 0.10);
    }

    h2{
      margin:0 0 10px 0;
      font-size: 18px;
      color: var(--primary);
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:flex-end;
    }

    label{
      font-size: 13px;
      font-weight: 700;
      color: var(--text);
    }

    input, textarea, select{
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px 12px;
      outline:none;
      color: var(--text);
      background: #fff;
    }
    textarea{ min-height: 84px; resize: vertical; }

    .field{
      min-width: 220px;
      flex: 1;
    }

    .small{
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px;
      line-height: 1.35;
    }

    .divider{
      height:1px;
      background: rgba(46,26,71,0.10);
      margin: 12px 0;
    }

    .kpiGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }
    @media (max-width: 900px){
      .kpiGrid{ grid-template-columns: repeat(2, 1fr); }
    }

    .kpi{
      background: rgba(191, 167, 242, 0.22);
      border: 1px solid rgba(123, 74, 226, 0.22);
      border-radius: 14px;
      padding: 12px;
    }
    .kpi .k{
      font-size: 12px;
      color: var(--muted);
    }
    .kpi .v{
      font-size: 18px;
      font-weight: 800;
      margin-top: 6px;
      color: var(--text);
    }

    .scriptureBox{
      background: rgba(191, 167, 242, 0.20);
      border: 1px solid rgba(123, 74, 226, 0.25);
      border-radius: 14px;
      padding: 12px;
    }

    .scriptureText{
      font-size: 13px;
      line-height: 1.55;
      color: var(--text);
      white-space: pre-wrap;
    }

    .checkRow{
      display:flex;
      gap: 14px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 10px;
    }
    .checkRow label{
      font-weight: 600;
      display:flex;
      align-items:center;
      gap: 8px;
    }
    .checkRow input[type="checkbox"]{
      width:auto;
      transform: scale(1.1);
      accent-color: var(--primary);
    }

    canvas{
      width:100%;
      border-radius: 14px;
      border: 1px solid rgba(46,26,71,0.12);
      background: #fff;
    }

    .listItem{
      padding: 10px;
      border: 1px solid rgba(46,26,71,0.12);
      border-radius: 14px;
      margin-bottom: 10px;
      background: #fff;
    }
    .listItem .meta{
      font-size: 13px;
      font-weight: 800;
    }
    .listItem .note{
      margin-top: 6px;
      font-size: 13px;
      color: var(--text);
      font-style: italic;
      white-space: pre-wrap;
    }
    .listItem .actions{
      margin-top: 10px;
      display:flex;
      gap: 8px;
      flex-wrap:wrap;
    }

    .center{
      min-height: 100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .authCard{
      max-width: 520px;
      width:100%;
      background:#fff;
      border-radius: 18px;
      padding: 18px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(123, 74, 226, 0.10);
    }
    .authCard h1{ font-size: 22px; }
    .authHint{
      font-size: 13px;
      color: var(--muted);
      line-height: 1.4;
      margin-top: 8px;
    }

    .hidden{ display:none !important; }
    .error{
      margin-top: 10px;
      color: #9b1c1c;
      font-size: 13px;
      font-weight: 700;
    }
    .ok{
      margin-top: 10px;
      color: #14532d;
      font-size: 13px;
      font-weight: 700;
    }
  </style>
</head>

<body>

<!-- AUTH SCREEN -->
<div id="authScreen" class="center">
  <div class="authCard">
    <div class="title">
      <h1>Lessie Bea Health CRM üíú</h1>
      <p class="sub">Private. Peaceful. Consistent.</p>
    </div>

    <div class="divider"></div>

    <!-- First time setup -->
    <div id="setupBox" class="hidden">
      <h2>First-time setup (creates your login)</h2>
      <div class="row">
        <div class="field">
          <label>Username</label>
          <input id="setupUser" autocomplete="username" placeholder="Create a username" />
        </div>
        <div class="field">
          <label>Password</label>
          <input id="setupPass" type="password" autocomplete="new-password" placeholder="Create a password" />
        </div>
      </div>
      <p class="authHint">
        This login is saved on <strong>this browser/device</strong> (localStorage). If you clear browser data, you‚Äôll need to set up again.
      </p>
      <button class="btn" onclick="createAccount()">Create Login</button>
      <div id="setupMsg" class="error"></div>
    </div>

    <!-- Login -->
    <div id="loginBox" class="hidden">
      <h2>Login</h2>
      <div class="row">
        <div class="field">
          <label>Username</label>
          <input id="loginUser" autocomplete="username" placeholder="Enter username" />
        </div>
        <div class="field">
          <label>Password</label>
          <input id="loginPass" type="password" autocomplete="current-password" placeholder="Enter password" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn" onclick="login()">Login</button>
        <button class="btn secondary" onclick="resetApp()">Reset App (if locked out)</button>
      </div>

      <p class="authHint">
        Reset clears this Health CRM‚Äôs local data in this browser only.
      </p>
      <div id="loginMsg" class="error"></div>
    </div>
  </div>
</div>

<!-- APP -->
<div id="appScreen" class="hidden">
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Lessie Bea Health CRM üíú</h1>
        <p class="sub" id="goalSubtitle"></p>
      </div>
      <div class="topActions">
        <span class="pill" id="helloUser"></span>
        <button class="btn light" onclick="logout()">Logout</button>
      </div>
    </header>

    <!-- DASHBOARD KPIs -->
    <div class="card">
      <h2>Dashboard</h2>
      <div class="kpiGrid">
        <div class="kpi">
          <div class="k">Start ‚Üí Goal</div>
          <div class="v" id="kpiStartGoal">247 ‚Üí 175</div>
        </div>
        <div class="kpi">
          <div class="k">Latest Friday</div>
          <div class="v" id="kpiLatestFriday">‚Äî</div>
        </div>
        <div class="kpi">
          <div class="k">Total Change</div>
          <div class="v" id="kpiTotalChange">‚Äî</div>
        </div>
        <div class="kpi">
          <div class="k">Days Logged</div>
          <div class="v" id="kpiDaysLogged">0</div>
        </div>
      </div>

      <div class="divider"></div>

      <!-- DAILY ANCHOR -->
      <div class="scriptureBox">
        <div class="row" style="align-items:center;">
          <div style="flex:1;">
            <strong>Daily Anchor ‚úùÔ∏è</strong>
            <div class="small">Read one verse. That counts.</div>
          </div>
          <div style="display:flex; gap:8px; flex-wrap:wrap;">
            <button class="btn light" onclick="showPsalm()">Psalm 23</button>
            <button class="btn light" onclick="showProverbs()">Proverbs 23</button>
          </div>
        </div>

        <div class="divider"></div>

        <div id="scriptureTitle" style="font-weight:800; margin-bottom:6px;">Psalm 23 (KJV)</div>
        <div id="scriptureText" class="scriptureText"></div>

        <div class="checkRow">
          <label><input type="checkbox" id="bibleRead"> Read Bible Today ‚úÖ</label>
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- DAILY CHECK-IN -->
      <div class="card">
        <h2>Daily Check-In (simple)</h2>

        <div class="row">
          <div class="field">
            <label>Date</label>
            <input type="date" id="dailyDate" />
          </div>
        </div>

        <div class="checkRow">
          <label><input type="checkbox" id="dailyWorkout"> Workout / Move ‚úÖ</label>
          <label><input type="checkbox" id="dailyWater"> Water Goal ‚úÖ</label>
          <label><input type="checkbox" id="dailyFood"> Food On Plan ‚úÖ</label>
        </div>

        <div style="margin-top:10px;">
          <label>Short Journal (1‚Äì3 sentences)</label>
          <textarea id="dailyJournal" maxlength="250" placeholder="How did today feel? Keep it kind."></textarea>
          <div class="small">Short is the goal. No pressure.</div>
        </div>

        <div class="row" style="margin-top:10px;">
          <button class="btn" onclick="saveDaily()">Save Daily Check-In</button>
        </div>

        <div id="dailyMsg" class="ok"></div>

        <div class="divider"></div>
        <strong>Recent Daily Notes</strong>
        <div id="dailyList" style="margin-top:10px;"></div>
      </div>

      <!-- FRIDAY WEIGH-IN -->
      <div class="card">
        <h2>Friday Weigh-In ‚öñÔ∏è</h2>

        <div class="row">
          <div class="field">
            <label>Date (Friday)</label>
            <input type="date" id="fridayDate" />
          </div>
          <div class="field">
            <label>Weight</label>
            <input type="number" id="fridayWeight" placeholder="Enter weight" step="0.1" />
          </div>
        </div>

        <div style="margin-top:10px;">
          <label>Friday Reflection / Prayer (short)</label>
          <textarea id="fridayPrayer" maxlength="400" placeholder="Lord, help me stay consistent and peaceful. Thank You for strength this week."></textarea>
          <div class="small">This is your quiet reset, not homework.</div>
        </div>

        <div class="row" style="margin-top:10px;">
          <button class="btn" onclick="saveFridayWeighIn()">Save Weigh-In</button>
        </div>

        <div class="divider"></div>

        <div class="scriptureBox">
          <strong>Monthly Milestone</strong>
          <div id="milestoneText" style="margin-top:8px;"></div>
        </div>

        <div class="divider"></div>

        <strong>Progress Chart</strong>
        <canvas id="weighInChart" width="900" height="260"></canvas>
        <div id="chartHint" class="small"></div>

        <div class="divider"></div>

        <strong>Weigh-In History</strong>
        <div id="weighInList" style="margin-top:10px;"></div>
      </div>
    </div>
  </div>
</div>

<script>
/* =======================
   CONFIG / GOAL
======================= */
const GOAL = {
  startWeight: 247,
  targetWeight: 175,
  startDate: "2026-02-20",
  endDate: "2026-12-31"
};

/* =======================
   STORAGE KEYS (separate from your real estate CRM)
======================= */
const KEY_AUTH_USER = "LBH_auth_user_v1";
const KEY_AUTH_HASH = "LBH_auth_hash_v1";
const KEY_SESSION   = "LBH_session_v1";

const KEY_DAILY      = "LBH_dailyLogs_v1";
const KEY_WEIGHINS   = "LBH_fridayWeighIns_v1";
const KEY_SCRIPTURE  = "LBH_scriptureChoice_v1";

/* =======================
   SCRIPTURES (KJV)
======================= */
const PSALM_23_KJV =
`1 The LORD is my shepherd; I shall not want.
2 He maketh me to lie down in green pastures: he leadeth me beside the still waters.
3 He restoreth my soul: he leadeth me in the paths of righteousness for his name's sake.
4 Yea, though I walk through the valley of the shadow of death, I will fear no evil: for thou art with me; thy rod and thy staff they comfort me.
5 Thou preparest a table before me in the presence of mine enemies: thou anointest my head with oil; my cup runneth over.
6 Surely goodness and mercy shall follow me all the days of my life: and I will dwell in the house of the LORD for ever.`;

const PROVERBS_23_KJV =
`1 When thou sittest to eat with a ruler, consider diligently what is before thee:
2 And put a knife to thy throat, if thou be a man given to appetite.
3 Be not desirous of his dainties: for they are deceitful meat.
4 Labour not to be rich: cease from thine own wisdom.
5 Wilt thou set thine eyes upon that which is not? for riches certainly make themselves wings; they fly away as an eagle toward heaven.
6 Eat thou not the bread of him that hath an evil eye, neither desire thou his dainty meats:
7 For as he thinketh in his heart, so is he: Eat and drink, saith he to thee; but his heart is not with thee.
8 The morsel which thou hast eaten shalt thou vomit up, and lose thy sweet words.
9 Speak not in the ears of a fool: for he will despise the wisdom of thy words.
10 Remove not the old landmark; and enter not into the fields of the fatherless:
11 For their redeemer is mighty; he shall plead their cause with thee.
12 Apply thine heart unto instruction, and thine ears to the words of knowledge.
13 Withhold not correction from the child: for if thou beatest him with the rod, he shall not die.
14 Thou shalt beat him with the rod, and shalt deliver his soul from hell.
15 My son, if thine heart be wise, my heart shall rejoice, even mine.
16 Yea, my reins shall rejoice, when thy lips speak right things.
17 Let not thine heart envy sinners: but be thou in the fear of the LORD all the day long.
18 For surely there is an end; and thine expectation shall not be cut off.
19 Hear thou, my son, and be wise, and guide thine heart in the way.
20 Be not among winebibbers; among riotous eaters of flesh:
21 For the drunkard and the glutton shall come to poverty: and drowsiness shall clothe a man with rags.
22 Hearken unto thy father that begat thee, and despise not thy mother when she is old.
23 Buy the truth, and sell it not; also wisdom, and instruction, and understanding.
24 The father of the righteous shall greatly rejoice: and he that begetteth a wise child shall have joy of him.
25 Thy father and thy mother shall be glad, and she that bare thee shall rejoice.
26 My son, give me thine heart, and let thine eyes observe my ways.
27 For a whore is a deep ditch; and a strange woman is a narrow pit.
28 She also lieth in wait as for a prey, and increaseth the transgressors among men.
29 Who hath woe? who hath sorrow? who hath contentions? who hath babbling? who hath wounds without cause? who hath redness of eyes?
30 They that tarry long at the wine; they that go to seek mixed wine.
31 Look not thou upon the wine when it is red, when it giveth his colour in the cup, when it moveth itself aright.
32 At the last it biteth like a serpent, and stingeth like an adder.
33 Thine eyes shall behold strange women, and thine heart shall utter perverse things.
34 Yea, thou shalt be as he that lieth down in the midst of the sea, or as he that lieth upon the top of a mast.
35 They have stricken me, shalt thou say, and I was not sick; they have beaten me, and I felt it not: when shall I awake? I will seek it yet again.`;

/* =======================
   STATE
======================= */
let dailyLogs = JSON.parse(localStorage.getItem(KEY_DAILY)) || [];
let fridayWeighIns = JSON.parse(localStorage.getItem(KEY_WEIGHINS)) || [];
let currentScripture = localStorage.getItem(KEY_SCRIPTURE) || "psalm";

/* =======================
   UTIL
======================= */
function escapeHtml(str){
  return (str || "")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

function toISODate(d){
  const yyyy = d.getFullYear();
  const mm = String(d.getMonth()+1).padStart(2,"0");
  const dd = String(d.getDate()).padStart(2,"0");
  return `${yyyy}-${mm}-${dd}`;
}

function isFriday(dateStr){
  const d = new Date(dateStr + "T00:00:00");
  return d.getDay() === 5;
}

function sortWeighIns(){
  fridayWeighIns.sort((a,b)=> (a.date > b.date ? 1 : -1));
}

function saveDailyToStorage(){
  localStorage.setItem(KEY_DAILY, JSON.stringify(dailyLogs));
}

function saveWeighInsToStorage(){
  localStorage.setItem(KEY_WEIGHINS, JSON.stringify(fridayWeighIns));
}

function setDefaultDailyDate(){
  const el = document.getElementById("dailyDate");
  if(!el) return;
  el.value = toISODate(new Date());
}

function setDefaultFridayDate(){
  const el = document.getElementById("fridayDate");
  if(!el) return;
  const today = new Date();
  const d = new Date(today);
  while(d.getDay() !== 5) d.setDate(d.getDate()-1);
  el.value = toISODate(d);
}

/* =======================
   AUTH (client-side)
======================= */
async function sha256(text){
  const enc = new TextEncoder().encode(text);
  const buf = await crypto.subtle.digest("SHA-256", enc);
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
}

function showAuth(){
  document.getElementById("authScreen").classList.remove("hidden");
  document.getElementById("appScreen").classList.add("hidden");

  const hasAccount = !!localStorage.getItem(KEY_AUTH_HASH) && !!localStorage.getItem(KEY_AUTH_USER);
  document.getElementById("setupBox").classList.toggle("hidden", hasAccount);
  document.getElementById("loginBox").classList.toggle("hidden", !hasAccount);

  document.getElementById("setupMsg").textContent = "";
  document.getElementById("loginMsg").textContent = "";
}

function showApp(){
  document.getElementById("authScreen").classList.add("hidden");
  document.getElementById("appScreen").classList.remove("hidden");
}

async function createAccount(){
  const u = (document.getElementById("setupUser").value || "").trim();
  const p = (document.getElementById("setupPass").value || "").trim();
  const msg = document.getElementById("setupMsg");

  if(u.length < 3){ msg.textContent = "Username must be at least 3 characters."; return; }
  if(p.length < 6){ msg.textContent = "Password must be at least 6 characters."; return; }

  const hash = await sha256(u + "::" + p);
  localStorage.setItem(KEY_AUTH_USER, u);
  localStorage.setItem(KEY_AUTH_HASH, hash);
  localStorage.setItem(KEY_SESSION, "1");

  initApp(u);
}

async function login(){
  const u = (document.getElementById("loginUser").value || "").trim();
  const p = (document.getElementById("loginPass").value || "").trim();
  const msg = document.getElementById("loginMsg");

  const savedU = localStorage.getItem(KEY_AUTH_USER);
  const savedH = localStorage.getItem(KEY_AUTH_HASH);
  if(!savedU || !savedH){
    msg.textContent = "No account found. Please set up again.";
    showAuth();
    return;
  }

  const hash = await sha256(u + "::" + p);
  if(u !== savedU || hash !== savedH){
    msg.textContent = "Wrong username or password.";
    return;
  }

  localStorage.setItem(KEY_SESSION, "1");
  initApp(u);
}

function logout(){
  localStorage.removeItem(KEY_SESSION);
  showAuth();
}

/* Reset only this Health CRM data (NOT your real estate CRM) */
function resetApp(){
  const ok = confirm("This will clear the Health CRM login + data on this browser only. Continue?");
  if(!ok) return;

  [KEY_AUTH_USER, KEY_AUTH_HASH, KEY_SESSION, KEY_DAILY, KEY_WEIGHINS, KEY_SCRIPTURE].forEach(k=>localStorage.removeItem(k));
  dailyLogs = [];
  fridayWeighIns = [];
  currentScripture = "psalm";
  showAuth();
}

/* =======================
   APP INIT
======================= */
function initApp(username){
  showApp();

  document.getElementById("helloUser").textContent = `Hi, ${username} üíú`;
  document.getElementById("goalSubtitle").textContent =
    `Goal: ${GOAL.startWeight} ‚Üí ${GOAL.targetWeight} by ${GOAL.endDate} | Friday weigh-ins only`;

  setDefaultDailyDate();
  setDefaultFridayDate();

  // scripture render
  if(currentScripture === "proverbs") showProverbs();
  else showPsalm();

  // load last bible read checkbox for today (from daily logs if exists)
  syncBibleCheckboxForToday();

  // render all
  renderDailyList();
  renderWeighInList();
  renderWeighInChart();
  renderMonthlyMilestone(getLatestWeighInDate());
  updateKPIs();
}

/* auto-login if session exists */
window.addEventListener("load", ()=>{
  const hasAccount = !!localStorage.getItem(KEY_AUTH_HASH) && !!localStorage.getItem(KEY_AUTH_USER);
  const session = localStorage.getItem(KEY_SESSION) === "1";
  if(hasAccount && session){
    initApp(localStorage.getItem(KEY_AUTH_USER));
  } else {
    showAuth();
  }
});

/* =======================
   SCRIPTURE TOGGLES
======================= */
function showPsalm(){
  currentScripture = "psalm";
  localStorage.setItem(KEY_SCRIPTURE, currentScripture);
  document.getElementById("scriptureTitle").textContent = "Psalm 23 (KJV)";
  document.getElementById("scriptureText").textContent = PSALM_23_KJV;
}

function showProverbs(){
  currentScripture = "proverbs";
  localStorage.setItem(KEY_SCRIPTURE, currentScripture);
  document.getElementById("scriptureTitle").textContent = "Proverbs 23 (KJV)";
  document.getElementById("scriptureText").textContent = PROVERBS_23_KJV;
}

/* =======================
   DAILY CHECK-IN
======================= */
function syncBibleCheckboxForToday(){
  const today = toISODate(new Date());
  const log = dailyLogs.find(d=>d.date===today);
  const bible = document.getElementById("bibleRead");
  if(!bible) return;
  bible.checked = !!(log && log.bibleRead);
}

function saveDaily(){
  const date = (document.getElementById("dailyDate").value || "").trim();
  if(!date){ return; }

  const entry = {
    date,
    workout: !!document.getElementById("dailyWorkout").checked,
    water: !!document.getElementById("dailyWater").checked,
    foodOnPlan: !!document.getElementById("dailyFood").checked,
    journal: (document.getElementById("dailyJournal").value || "").trim(),
    bibleRead: !!document.getElementById("bibleRead").checked
  };

  const idx = dailyLogs.findIndex(d=>d.date===date);
  if(idx >= 0) dailyLogs[idx] = entry;
  else dailyLogs.push(entry);

  // sort newest first (for list display)
  dailyLogs.sort((a,b)=> (a.date < b.date ? 1 : -1));
  saveDailyToStorage();

  // friendly confirmation
  const msg = document.getElementById("dailyMsg");
  msg.textContent = "Saved. You showed up today üíú";

  // clear journal box (optional)
  document.getElementById("dailyJournal").value = "";

  renderDailyList();
  updateKPIs();
}

function renderDailyList(){
  const wrap = document.getElementById("dailyList");
  if(!wrap) return;

  if(dailyLogs.length === 0){
    wrap.innerHTML = `<div class="small">No daily logs yet. Start with today.</div>`;
    return;
  }

  const items = dailyLogs.slice(0,6).map(d=>{
    const checks = [
      d.bibleRead ? "‚úùÔ∏è Bible" : null,
      d.workout ? "üèÉ Move" : null,
      d.water ? "üíß Water" : null,
      d.foodOnPlan ? "üçΩ On plan" : null
    ].filter(Boolean).join(" ‚Ä¢ ");

    return `
      <div class="listItem">
        <div class="meta">${d.date}${checks ? " ‚Äî " + checks : ""}</div>
        ${d.journal ? `<div class="note">${escapeHtml(d.journal)}</div>` : `<div class="small">No note.</div>`}
      </div>
    `;
  }).join("");

  wrap.innerHTML = items;
}

/* =======================
   FRIDAY WEIGH-INS
======================= */
function getLatestWeighInDate(){
  if(fridayWeighIns.length === 0) return null;
  sortWeighIns();
  return fridayWeighIns[fridayWeighIns.length - 1].date;
}

function saveFridayWeighIn(){
  const date = (document.getElementById("fridayDate").value || "").trim();
  const w = parseFloat(document.getElementById("fridayWeight").value);
  const prayer = (document.getElementById("fridayPrayer").value || "").trim();

  if(!date){ alert("Please choose a date."); return; }
  if(!Number.isFinite(w) || w <= 0){ alert("Please enter a valid weight."); return; }

  if(!isFriday(date)){
    const ok = confirm("That date is not a Friday. Save anyway?");
    if(!ok) return;
  }

  const entry = { date, weight: w, prayer };

  const idx = fridayWeighIns.findIndex(x=>x.date===date);
  if(idx >= 0) fridayWeighIns[idx] = entry;
  else fridayWeighIns.push(entry);

  sortWeighIns();
  saveWeighInsToStorage();

  // clear weight field only
  document.getElementById("fridayWeight").value = "";

  renderWeighInList();
  renderWeighInChart();
  renderMonthlyMilestone(date);
  updateKPIs();

  document.getElementById("chartHint").textContent = "Saved. Weekly data > daily emotions üíú";
}

function renderWeighInList(){
  const wrap = document.getElementById("weighInList");
  if(!wrap) return;

  if(fridayWeighIns.length === 0){
    wrap.innerHTML = `<div class="small">No weigh-ins yet. Start this Friday üíú</div>`;
    return;
  }

  const reversed = fridayWeighIns.slice().reverse();
  wrap.innerHTML = reversed.map(w=>{
    return `
      <div class="listItem">
        <div class="meta">${w.date} ‚Äî ${w.weight} lbs</div>
        ${w.prayer ? `<div class="note">${escapeHtml(w.prayer)}</div>` : `<div class="small">No prayer/reflection.</div>`}
        <div class="actions">
          <button class="btn light" onclick="editWeighIn('${w.date}')">Edit</button>
          <button class="btn secondary" onclick="deleteWeighIn('${w.date}')">Delete</button>
        </div>
      </div>
    `;
  }).join("");
}

function editWeighIn(date){
  const found = fridayWeighIns.find(w=>w.date===date);
  if(!found) return;
  document.getElementById("fridayDate").value = found.date;
  document.getElementById("fridayPrayer").value = found.prayer || "";
  document.getElementById("fridayWeight").value = found.weight;
  window.scrollTo({ top: 0, behavior: "smooth" });
}

function deleteWeighIn(date){
  const ok = confirm("Delete this weigh-in?");
  if(!ok) return;
  fridayWeighIns = fridayWeighIns.filter(w=>w.date!==date);
  saveWeighInsToStorage();
  renderWeighInList();
  renderWeighInChart();
  renderMonthlyMilestone(getLatestWeighInDate());
  updateKPIs();
}

/* A) Chart (simple canvas line) */
function renderWeighInChart(){
  const canvas = document.getElementById("weighInChart");
  const hint = document.getElementById("chartHint");
  if(!canvas) return;
  const ctx = canvas.getContext("2d");
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const padding = 40, W = canvas.width, H = canvas.height;

  // frame
  ctx.strokeStyle = "rgba(46,26,71,0.18)";
  ctx.lineWidth = 1;
  ctx.strokeRect(padding, padding, W-padding*2, H-padding*2);

  ctx.strokeStyle = "rgba(46,26,71,0.08)";
  for(let i=1;i<=3;i++){
    const y = padding + i*(H - padding*2)/4;
    ctx.beginPath(); ctx.moveTo(padding, y); ctx.lineTo(W-padding, y); ctx.stroke();
  }

  if(fridayWeighIns.length < 2){
    if(hint) hint.textContent = "Add at least 2 weigh-ins to see a line.";
    return;
  }

  sortWeighIns();
  const weights = fridayWeighIns.map(x=>x.weight);
  const minW = Math.min(...weights);
  const maxW = Math.max(...weights);
  const range = Math.max(5, maxW - minW);
  const yMin = minW - range*0.15;
  const yMax = maxW + range*0.15;

  // labels
  ctx.fillStyle = "rgba(46,26,71,0.9)";
  ctx.font = "12px Arial";
  ctx.fillText(`${Math.round(yMax)} lbs`, 8, padding-10);
  ctx.fillText(`${Math.round(yMin)} lbs`, 8, H - 10);

  // line
  ctx.strokeStyle = "rgba(123, 74, 226, 0.95)";
  ctx.lineWidth = 3;
  ctx.beginPath();

  fridayWeighIns.forEach((pt, i)=>{
    const x = padding + (i*(W - padding*2)) / (fridayWeighIns.length - 1);
    const y = padding + ((yMax - pt.weight) * (H - padding*2)) / (yMax - yMin);
    if(i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  });
  ctx.stroke();

  // points
  ctx.fillStyle = "rgba(46,26,71,0.9)";
  fridayWeighIns.forEach((pt, i)=>{
    const x = padding + (i*(W - padding*2)) / (fridayWeighIns.length - 1);
    const y = padding + ((yMax - pt.weight) * (H - padding*2)) / (yMax - yMin);
    ctx.beginPath(); ctx.arc(x,y,4,0,Math.PI*2); ctx.fill();
  });

  const start = fridayWeighIns[0].weight;
  const latest = fridayWeighIns[fridayWeighIns.length - 1].weight;
  const change = (start - latest);
  if(hint) hint.textContent = `Start: ${start} ‚Üí Latest: ${latest} (Change: ${change.toFixed(1)} lbs)`;
}

/* B) Monthly milestone (linear target to year end) */
function renderMonthlyMilestone(referenceDateStr){
  const box = document.getElementById("milestoneText");
  if(!box) return;

  const latestDate = referenceDateStr || getLatestWeighInDate();
  if(!latestDate){
    box.innerHTML = `<div class="small">No weigh-ins yet. Your journey still counts üíú</div>`;
    return;
  }

  const latest = fridayWeighIns.find(w=>w.date===latestDate) || fridayWeighIns[fridayWeighIns.length-1];
  const target = getTargetWeightForMonth(latest.date);
  const diff = latest.weight - target;

  const direction = diff <= 0
    ? `You‚Äôre <strong>${Math.abs(diff).toFixed(1)} lbs</strong> ahead of this month‚Äôs target.`
    : `You‚Äôre <strong>${diff.toFixed(1)} lbs</strong> above this month‚Äôs target (still okay‚Äîfocus on habits).`;

  box.innerHTML = `
    <div><strong>Month target:</strong> ${target.toFixed(1)} lbs</div>
    <div style="margin-top:8px;">${direction}</div>
    <div class="small" style="margin-top:10px;">
      Proverbs 23:18 ‚Äî ‚ÄúFor surely there is an end; and thine expectation shall not be cut off.‚Äù
    </div>
  `;
}

function getTargetWeightForMonth(dateStr){
  const startD = new Date(GOAL.startDate + "T00:00:00");
  const endD   = new Date(GOAL.endDate + "T00:00:00");
  const d      = new Date(dateStr + "T00:00:00");

  // end of month for d
  const monthEnd = new Date(d.getFullYear(), d.getMonth()+1, 0);
  const clampMs = Math.min(Math.max(monthEnd.getTime(), startD.getTime()), endD.getTime());

  const totalMs = endD - startD;
  const doneMs  = clampMs - startD.getTime();
  const t = totalMs <= 0 ? 1 : Math.min(1, Math.max(0, doneMs / totalMs));

  return GOAL.startWeight + (GOAL.targetWeight - GOAL.startWeight) * t;
}

/* =======================
   KPIs
======================= */
function updateKPIs(){
  document.getElementById("kpiStartGoal").textContent = `${GOAL.startWeight} ‚Üí ${GOAL.targetWeight}`;

  // Days logged
  document.getElementById("kpiDaysLogged").textContent = String(dailyLogs.length);

  // Latest Friday
  if(fridayWeighIns.length === 0){
    document.getElementById("kpiLatestFriday").textContent = "‚Äî";
    document.getElementById("kpiTotalChange").textContent = "‚Äî";
    return;
  }

  sortWeighIns();
  const latest = fridayWeighIns[fridayWeighIns.length - 1];
  document.getElementById("kpiLatestFriday").textContent = `${latest.weight} lbs`;

  const startW = GOAL.startWeight;
  const change = (startW - latest.weight);
  const sign = change >= 0 ? "-" : "+";
  document.getElementById("kpiTotalChange").textContent = `${sign}${Math.abs(change).toFixed(1)} lbs`;
}
</script>

</body>
</html></pre>
        </body>
    </html>